pipeline:
  agent: any

  parameters:
    - name: STACK_NAME
      default: my-stack
      description: Name of the CloudFormation stack
    - name: REGION
      default: us-east-1
      description: AWS region where the stack will be deployed
    - name: ACTION
      choices:
        - create
        - update
        - delete
      description: Action to perform on the CloudFormation stack

  stages:
    - name: Checkout code
      steps:
        - git:
            url: https://github.com/your-repo/your-project.git
            branch: master

    - name: Deploy CloudFormation
      when:
        expression: params.ACTION != 'delete'
      steps:
        - script:
            sh: "aws cloudformation ${params.ACTION} --stack-name ${params.STACK_NAME} --template-file template.yaml --region ${params.REGION}"

    - name: Delete CloudFormation
      when:
        expression: params.ACTION == 'delete'
      steps:
        - script:
            sh: "aws cloudformation ${params.ACTION} --stack-name ${params.STACK_NAME} --region ${params.REGION}"

**Key Points:**

- The overall structure remains the same, using stages for different actions.
- Parameters are defined with names, default values, and descriptions.
- `when` conditions ensure specific steps execute based on the chosen `ACTION` parameter.
- The `script` step now uses YAML syntax for shell commands.

**Remember:**

- Replace `https://github.com/your-repo/your-project.git` with your actual repository URL.
- Change `template.yaml` to the filename of your CloudFormation template.
- Adapt the `aws cloudformation` command arguments based on your specific needs.
- Securely manage your AWS credentials using environment variables or secrets management tools.

I hope this helps! Feel free to ask if you have any further questions or need more specific adaptations for your project.


################################333333333333333333333333###3333333333333333333333333########################################

pipeline {
  agent any

  parameters {
    string(name: 'STACK_NAME', defaultValue: 'my-stack')
    string(name: 'REGION', defaultValue: 'us-east-1')
    string(name: 'ACTION', choices: ['create', 'update', 'delete'])
  }

  stages {
    stage('Checkout code') {
      steps {
        git branch: 'master', url: 'https://github.com/your-repo/your-project.git'
      }
    }
    stage('Deploy CloudFormation') {
      when { expression { params.ACTION != 'delete' } }
      steps {
        sh "aws cloudformation ${params.ACTION} --stack-name ${params.STACK_NAME} --template-file template.yaml --region ${params.REGION}"
      }
    }
    stage('Delete CloudFormation') {
      when { expression { params.ACTION == 'delete' } }
      steps {
        sh "aws cloudformation ${params.ACTION} --stack-name ${params.STACK_NAME} --region ${params.REGION}"
      }
    }
  }
}
